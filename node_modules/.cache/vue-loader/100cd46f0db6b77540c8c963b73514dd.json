{"remainingRequest":"D:\\domain\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\domain\\src\\views\\Settings\\Settings.vue?vue&type=style&index=0&id=12241665&lang=scss&scoped=true&","dependencies":[{"path":"D:\\domain\\src\\views\\Settings\\Settings.vue","mtime":1614152500527},{"path":"D:\\domain\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\domain\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\domain\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\domain\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\domain\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\domain\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi50YWJsZVRvcCB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7DQogIG1hcmdpbjogNDFweCAwIDAgMDsNCn0NCi51c2VyLWNvbnRlbnQgew0KICB3aWR0aDogNjAwcHg7DQogIG1hcmdpbjogMCBhdXRvOw0KICAuZWwtZm9ybSB7DQogICAgLmVsLWZvcm0taXRlbV9fbGFiZWwgew0KICAgICAgY29sb3I6ICM4NjhlOTY7DQogICAgfQ0KICAgIC5lbC1mb3JtLWl0ZW1fX2NvbnRlbnQgew0KICAgICAgbWFyZ2luLWxlZnQ6IDM1JSAhaW1wb3J0YW50Ow0KICAgIH0NCiAgICAuZWwtaW5wdXQtLXN1ZmZpeCAuZWwtaW5wdXRfX2lubmVyIHsNCiAgICAgIGNvbG9yOiAjODY4ZTk2Ow0KICAgIH0NCiAgfQ0KICAuZm9vdGVyIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgbWFyZ2luOiAzMHB4IDQwcHggMCAwOw0KICAgIHNwYW4gew0KICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgICAgd2lkdGg6IDY1cHg7DQogICAgICBoZWlnaHQ6IDM4cHg7DQogICAgICBsaW5lLWhlaWdodDogMzhweDsNCiAgICAgIG9wYWNpdHk6IDAuNzY7DQogICAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgICBmb250LXNpemU6IDE2cHg7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgfQ0KICAgIC5zdWJtaXQgew0KICAgICAgYm9yZGVyOiBzb2xpZCAxcHggIzU1OTVjODsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM2NmFmZTk7DQogICAgICBjb2xvcjogI2ZmZjsNCiAgICAgIG1hcmdpbi1yaWdodDogMjBweDsNCiAgICB9DQogICAgLmJhY2sgew0KICAgICAgYm9yZGVyOiBzb2xpZCAxcHggIzg2OGU5NjsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7DQogICAgICBjb2xvcjogIzg2OGU5NjsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Settings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Settings.vue","sourceRoot":"src/views/Settings","sourcesContent":["<template>\r\n  <div class=\"content\">\r\n    <div class=\"tableTop\">\r\n      <el-button type=\"primary\" @click=\"openUser\">添加用户</el-button>\r\n    </div>\r\n    <div class=\"table\">\r\n      <Tables\r\n        :data=\"table.data\"\r\n        :columns=\"table.columns\"\r\n        :pageShow=\"false\"\r\n        :loading=\"table.loading\"\r\n        @clickButton=\"clickButton\"\r\n        :tableOption=\"table.tableOption\"\r\n      >\r\n      </Tables>\r\n    </div>\r\n    <div class=\"addUser\">\r\n      <Dailog\r\n        :title=\"title\"\r\n        :width=\"'35%'\"\r\n        :show.sync=\"userShow\"\r\n        @closeDialog=\"onCloseKey\"\r\n      >\r\n        <div slot=\"content\" class=\"user-content\">\r\n          <el-form :model=\"formData\" :rules=\"rules\" ref=\"formData\" class=\"form\">\r\n            <el-form-item\r\n              label=\"用户名\"\r\n              prop=\"name\"\r\n              :label-width=\"formLabelWidth\"\r\n            >\r\n              <el-input\r\n                v-model=\"formData.name\"\r\n                placeholder=\"请输入用户名\"\r\n                @input=\"nameChange\"\r\n                style=\"width: 60%\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item\r\n              label=\"信箱\"\r\n              prop=\"email\"\r\n              :label-width=\"formLabelWidth\"\r\n            >\r\n              <el-input\r\n                v-model=\"formData.email\"\r\n                placeholder=\"请输入信箱\"\r\n                @input=\"changeEmail\"\r\n                style=\"width: 60%\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <div v-if=\"!isEdit\">\r\n              <el-form-item\r\n                label=\"请输入密码\"\r\n                prop=\"password\"\r\n                :label-width=\"formLabelWidth\"\r\n              >\r\n                <el-input\r\n                  v-model=\"formData.password\"\r\n                  @input=\"changePwd\"\r\n                  placeholder=\"请输入密码\"\r\n                  style=\"width: 60%\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"重复密码\"\r\n                prop=\"password_confirmation\"\r\n                :label-width=\"formLabelWidth\"\r\n              >\r\n                <el-input\r\n                  v-model=\"formData.password_confirmation\"\r\n                  @input=\"changePwdCon\"\r\n                  placeholder=\"请输入重复密码\"\r\n                  style=\"width: 60%\"\r\n                ></el-input>\r\n              </el-form-item>\r\n            </div>\r\n            <div v-if=\"isEdit\">\r\n              <el-form-item\r\n                label=\"请输入原密码\"\r\n                prop=\"old_password\"\r\n                :label-width=\"formLabelWidth\"\r\n              >\r\n                <el-input\r\n                  v-model=\"formData.old_password\"\r\n                  placeholder=\"请输入密码\"\r\n                  @input=\"changeOldPwd\"\r\n                  style=\"width: 60%\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"请输入新密码\"\r\n                prop=\"password\"\r\n                :label-width=\"formLabelWidth\"\r\n              >\r\n                <el-input\r\n                  v-model=\"formData.password\"\r\n                  placeholder=\"请输入密码\"\r\n                  @input=\"changePwd\"\r\n                  style=\"width: 60%\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"重复新密码\"\r\n                prop=\"password_confirmation\"\r\n                :label-width=\"formLabelWidth\"\r\n              >\r\n                <el-input\r\n                  v-model=\"formData.password_confirmation\"\r\n                  @input=\"changePwdCon\"\r\n                  placeholder=\"请输入重复密码\"\r\n                  style=\"width: 60%\"\r\n                ></el-input>\r\n              </el-form-item>\r\n            </div>\r\n            <el-form-item label=\"权限\" :label-width=\"formLabelWidth\">\r\n              <el-select\r\n                v-model=\"formData.role\"\r\n                placeholder=\"请选择\"\r\n                style=\"width: 30%\"\r\n              >\r\n                <el-option\r\n                  v-for=\"item in options\"\r\n                  :key=\"item.value\"\r\n                  :label=\"item.label\"\r\n                  :value=\"item.value\"\r\n                >\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-form>\r\n          <div class=\"footer\">\r\n            <span class=\"submit\" @click=\"submitForm('formData')\">确定</span>\r\n            <span class=\"back\" @click=\"back\">返回</span>\r\n          </div>\r\n        </div>\r\n      </Dailog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Tables from \"../../components/tables/table\";\r\nimport Dailog from \"../../components/dialogs/dialog\";\r\nimport {\r\n  getUserList,\r\n  getUserInfo,\r\n  addRegister,\r\n  delelteUser,\r\n  updateUser,\r\n} from \"@/api\";\r\nimport { spawn } from \"child_process\";\r\nexport default {\r\n  name: \"Settings\",\r\n  components: { Tables, Dailog },\r\n  data() {\r\n    var checkName = (rule, val, cb) => {\r\n      if (!this.formData.name || this.formData.name === \"\") {\r\n        return cb(new Error(\"请输入用户名\"));\r\n      } else {\r\n        cb();\r\n      }\r\n    };\r\n    var checkEmail = (rule, val, cb) => {\r\n      let reg = /^([a-zA-Z]|[0-9])(\\w|\\-)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/;\r\n      if (!this.formData.email || this.formData.email == \"\") {\r\n        return cb(new Error(\"请输入信箱地址\"));\r\n      } else if (!reg.test(this.formData.email.trim())) {\r\n        return cb(new Error(\"请输入正确的箱邮\"));\r\n      } else {\r\n        cb();\r\n      }\r\n    };\r\n    var checkOldPwd = (rule, val, cb) => {\r\n      if (!this.formData.old_password || this.formData.old_password == \"\") {\r\n        return cb(new Error(\"请输入原密码\"));\r\n      } else if (this.formData.old_password.trim().length < 8) {\r\n        return cb(new Error(\"原密码最少八位\"));\r\n      } else {\r\n        cb();\r\n      }\r\n    };\r\n    var checkPwd1 = (rule, val, cb) => {\r\n      if (!this.formData.password || this.formData.password == \"\") {\r\n        return cb(new Error(\"请输入密码\"));\r\n      } else if (this.formData.password.trim().length < 8) {\r\n        return cb(new Error(\"密码最少八位\"));\r\n      } else {\r\n        cb();\r\n      }\r\n    };\r\n    var checkPwd2 = (rule, val, cb) => {\r\n      if (\r\n        !this.formData.password_confirmation ||\r\n        this.formData.password_confirmation == \"\"\r\n      ) {\r\n        return cb(new Error(\"请再次输入密码\"));\r\n      } else if (this.formData.password_confirmation.trim().length < 8) {\r\n        return cb(new Error(\"密码最少八位\"));\r\n      } else if (\r\n        this.formData.password_confirmation.trim() !==\r\n        this.formData.password.trim()\r\n      ) {\r\n        return cb(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        cb();\r\n      }\r\n    };\r\n    return {\r\n      formLabelWidth: \"30%\",\r\n      userShow: false,\r\n      title: \"添加用户\",\r\n      isEdit: false,\r\n      options: [\r\n        {\r\n          value: 1,\r\n          label: \"Admin\",\r\n        },\r\n        {\r\n          value: 2,\r\n          label: \"Guest\",\r\n        },\r\n      ],\r\n      formData: {\r\n        id: null,\r\n        name: \"\",\r\n        email: \"\",\r\n        password: \"\",\r\n        old_password: \"\",\r\n        password_confirmation: \"\",\r\n        old_password: \"\",\r\n        role: 1,\r\n      },\r\n      rules: {\r\n        name: [{ validator: checkName, trigger: \"blur\" }],\r\n        email: [{ validator: checkEmail, trigger: \"blur\" }],\r\n        old_password: [{ validator: checkOldPwd, trigger: \"blur\" }],\r\n        password: [{ validator: checkPwd1, trigger: \"blur\" }],\r\n        password_confirmation: [{ validator: checkPwd2, trigger: \"blur\" }],\r\n        // role: [\r\n        //     { validator: checkRole, trigger: 'change' }\r\n        // ],\r\n      },\r\n      table: {\r\n        loading: false,\r\n        page: 1,\r\n        rows: 10,\r\n        total: 0,\r\n        columns: [\r\n          {\r\n            label: \"ID\",\r\n            key: \"id\",\r\n            width: \"60\",\r\n          },\r\n          {\r\n            label: \"用户名\",\r\n            key: \"name\",\r\n          },\r\n          {\r\n            label: \"权限\",\r\n            key: \"role\",\r\n            width: \"100\",\r\n            render: (row) => {\r\n              return row.role === 1 ? \"Admin\" : \"Guest\";\r\n            },\r\n          },\r\n          {\r\n            label: \"信箱\",\r\n            key: \"email\",\r\n          },\r\n          {\r\n            label: \"最后登录时间\",\r\n            key: \"updated_at\",\r\n          },\r\n          {\r\n            label: \"访问次数\",\r\n            key: \"visit_times\",\r\n            width: \"100\",\r\n          },\r\n        ],\r\n        data: [],\r\n        // 表格操作\r\n        tableOption: {\r\n          label: \"操作\",\r\n          options: [\r\n            {\r\n              label: \"编辑\",\r\n              bgColor: \"#5bbfdf\",\r\n              methods: \"edit\",\r\n            },\r\n            {\r\n              label: \"删除\",\r\n              bgColor: \"#fac167\",\r\n              methods: \"del\",\r\n            },\r\n          ],\r\n        },\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    this.getData();\r\n  },\r\n\r\n  methods: {\r\n    //获取用户数据\r\n    getData() {\r\n      this.table.loading = true;\r\n      getUserList()\r\n        .then((res) => {\r\n          if (res !== undefined && res.code === 200) {\r\n            this.table.data = res.data;\r\n            this.table.loading = false;\r\n          } else {\r\n            let text = res.message;\r\n            this.$alert(`${text}`, \"温馨提示\", {\r\n              confirmButtonText: \"确定\",\r\n            });\r\n            this.table.data = [];\r\n            this.table.loading = false;\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          this.table.loading = false;\r\n        });\r\n    },\r\n    //添加用户\r\n    openUser() {\r\n      this.userShow = true;\r\n      this.isEdit = false;\r\n      this.title = \"添加新用户\";\r\n      this.formData.name = \"\";\r\n      this.formData.email = \"\";\r\n      this.formData.password = null;\r\n      this.formData.password_confirmation = null;\r\n      this.formData.role = 1;\r\n    },\r\n    back() {\r\n      this.userShow = false;\r\n      this.formData.name = \"\";\r\n      this.formData.email = \"\";\r\n      this.formData.password = null;\r\n      this.formData.password_confirmation = null;\r\n      this.formData.role = 1;\r\n      this.$refs.formData.resetFields();\r\n    },\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (!this.isEdit) {\r\n            addRegister(this.formData).then((res) => {\r\n              if (res !== undefined && res.code === 200) {\r\n                this.userShow = false;\r\n                this.$message({\r\n                  message: \"添加用户成功！\",\r\n                  type: \"success\",\r\n                });\r\n                this.getData();\r\n              } else {\r\n                let text = res.message;\r\n                this.$alert(`${text}`, \"温馨提示\", {\r\n                  confirmButtonText: \"确定\",\r\n                });\r\n              }\r\n            });\r\n          }\r\n          if (this.isEdit) {\r\n            updateUser(this.formData).then((res) => {\r\n              if (res !== undefined && res.code === 200) {\r\n                this.userShow = false;\r\n                this.$message({\r\n                  message: \"用户信息更新成功！\",\r\n                  type: \"success\",\r\n                });\r\n                this.getData();\r\n              } else {\r\n                let text = res.message;\r\n                this.$alert(`${text}`, \"温馨提示\", {\r\n                  confirmButtonText: \"确定\",\r\n                });\r\n              }\r\n            });\r\n          }\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    onCloseKey() {\r\n      this.$refs.formData.resetFields();\r\n    },\r\n    clickButton(val) {\r\n      if (val.methods === \"edit\") {\r\n        this.userShow = true;\r\n        this.title = \"编辑\";\r\n        this.isEdit = true;\r\n        this.formData.id = val.row.id;\r\n        this.formData.name = val.row.name;\r\n        this.formData.email = val.row.email;\r\n        this.formData.old_password = null;\r\n        this.formData.password = null;\r\n        this.formData.password_confirmation = null;\r\n        this.formData.role = val.row.role;\r\n      }\r\n      if (val.methods === \"del\") {\r\n        this.$confirm(\"此操作将永久删除该用户, 是否继续?\", \"温馨提示\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n        })\r\n          .then(() => {\r\n            let formData = new FormData();\r\n            formData.append(\"id\", val.row.id);\r\n            delelteUser(formData).then((res) => {\r\n              if (res !== undefined && res.code === 200) {\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"删除用户成功!\",\r\n                });\r\n                this.getData();\r\n              }\r\n            });\r\n          })\r\n          .catch(() => {\r\n            this.$message({\r\n              type: \"info\",\r\n              message: \"已取消删除\",\r\n            });\r\n          });\r\n      }\r\n    },\r\n    nameChange(val) {\r\n      this.formData.name = val.replace(/[, ]/g, \"\");\r\n    },\r\n    changeEmail(val) {\r\n      this.formData.email = val.replace(/[, ]/g, \"\");\r\n    },\r\n    changeOldPwd(val) {\r\n      this.formData.old_password = val.replace(/[, ]/g, \"\");\r\n    },\r\n    changePwd(val) {\r\n      this.formData.password = val.replace(/[, ]/g, \"\");\r\n    },\r\n    changePwdCon(val) {\r\n      this.formData.password_confirmation = val.replace(/[, ]/g, \"\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.tableTop {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin: 41px 0 0 0;\r\n}\r\n.user-content {\r\n  width: 600px;\r\n  margin: 0 auto;\r\n  .el-form {\r\n    .el-form-item__label {\r\n      color: #868e96;\r\n    }\r\n    .el-form-item__content {\r\n      margin-left: 35% !important;\r\n    }\r\n    .el-input--suffix .el-input__inner {\r\n      color: #868e96;\r\n    }\r\n  }\r\n  .footer {\r\n    text-align: center;\r\n    margin: 30px 40px 0 0;\r\n    span {\r\n      display: inline-block;\r\n      width: 65px;\r\n      height: 38px;\r\n      line-height: 38px;\r\n      opacity: 0.76;\r\n      border-radius: 4px;\r\n      font-size: 16px;\r\n      text-align: center;\r\n      cursor: pointer;\r\n    }\r\n    .submit {\r\n      border: solid 1px #5595c8;\r\n      background-color: #66afe9;\r\n      color: #fff;\r\n      margin-right: 20px;\r\n    }\r\n    .back {\r\n      border: solid 1px #868e96;\r\n      background-color: #ffffff;\r\n      color: #868e96;\r\n    }\r\n  }\r\n}\r\n</style>"]}]}